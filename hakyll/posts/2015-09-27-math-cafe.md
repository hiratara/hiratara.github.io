---
title: 今日は 数学カフェ の日です
mathjax: on
---

[数学カフェ](https://www.facebook.com/mathcafejapan) に来ていますので、メモを残しておきます。

* 就職しても数学を学びたい、これからを就職する学生さん、数学好きな女性を増やしたい
* 今日はデータサイエンスの数学的な部分をきちんとやりたい

## @pseudo_finite さん「データ分析における数理最適化」

* 学生時代は数理論理学やってた
    * $N + Z$ もペアノの公理を満たす(前の数取れるので)
* 「データサイエンティスト」ではなく「研究員」
* データ分析
    * wikipedia : データを用いて分析
    * ビジネス : 意思決定・施策
        * 現象を知る、施策を打つ
        * データの元となる現象を解明
* データ分析の結果を誰が使うか
    * 経営 : モニタリング・ざっくりした結果
    * 現場 : アナリスト的
    * システム : プログラマ寄り・機械に落とし込む
* 現象・施策のバランス == ビジネスインパクト
    * 「日経平均と強い相関」コントロールできない、施策が打てない
* レコメンデーション
    * Conversion UP、(顧客|店舗)満足度UP
    * 例: ホテル、本、ニュース、不動産、異性、広告、SNSの友達
    * 商品を個人へ？ クラスタリング？
* レコメンデーション戦略
    * データ: 顧客・商品・属性、履歴、事前知識
    * シーン : タイミング、個数
* 技術
    * 協調フィルタリング、LR、SVM、隠れ状態系(NMF、pLSA、LDA)、数理最適化、RF-確率表
    * 隠れ状態系はあまり現場で使われてない
    * スコアのテーブルを作るのが目標
* RF-確率表
    * タスク例 : 10週間のログから、顧客が閲覧する物件を予測 (TOP N レコメンド)
* 分析の流れ
    * データクレンジング
        * BOT(はずれ値)、0/1 のカラムに日本語が入ってる(QUERY STRINGを生で突っ込んでるとか)
        * 苦行。ロジック実装後にクレンジングすることもよくある
    * 可視化・基礎集計 (分析の方針を決定する)
    * 分析用DBを作成
    * 特徴量を洗い出したり
* 可視化
    * 人間が理解しやすい形に
    * 1万ユーザくらいテキストファイルにして見る。通勤電車で1,000ユーザくらいずつ
* RF-確率表 : RecencyとFrequencyで確率を出す
    * 実績値を確率とする？
    * 単調性制約 : Recencyが小さい、Frequencyが大きいほど閲覧、という仮定
    * 実績値は単調性制約を満たさない　(オーバーフィッティング)
    * 確率表を推定する！
* 確率表の推定
    * 単調性制約を満たす
    * データ件数が多いセルの閲覧確率は信頼
    * $p_{ij}$ 実績。 $x_{ij}$ 推定。
    * 単調性制約を入れる
    * 数理最適化問題として、ソルバーで解く
* RF-確率表のまとめ
    * 実装が簡単
    * チューニングがいらない (ノンパラメトリック)
    * 運用が現実的
* Q. 小数データというのは、個々人で再現してデータが少ないから？
    * A. この案件は大規模だから気にしなくていい。小規模な応用とか、商品の違いとかでデータが減る
* Q. Recencyとか冪分布になりそう。
    * A. 対数分布になりそうだけどやってない。ECサイトによって減衰が違うはず。関数形を仮定しなくていい
* Q. ロングテールが問題になりそうだけど？
    * A. 気にしてない。時計とかだとなりそう。不動産だと1 conversionで終わりとか。
* Q. binの切り方を工夫した方がいいのでは？
    * A. 課題はあるのか優先順位は低い。FとRをどうとるか。
* Q. 一定数溜まったbinのみを使うとかしない？
    * A. 議論はあった。1次元は簡単。2次元だと・・・。簡単さを求めているが、将来はやりたい
* 制約付きレコメンデーション
    * TOP Nではなく、バランスを考慮したリコメンドが必要
    * 1つの商品ではなくいろんな商品を売りたい
    * 売れ行き悪い商品の援護
    * 過剰レコメンドの抑制(店舗の課金を加味。いいホテルは勝手に売れる)
    * 顧客のリピート率、顧客育成
* 例えば、各商品の期待利得を1000円以上とか
    * $x_{ui}$ user×itemの割り当てテーブル、$e_{ui}$ CV期待値
    * 商品数$\sum{x_{ui}}$ や 期待コンバージョン数 $\sum{x_{ui}e_{ui}}$ に制約
* 素直なモデルの問題
    * CV数が現実的ではなく解がない
    * 変数のオーダーが10,000オーダーでソルバが厳しい
        * 100顧客×100商品・・・
    * レコメンド可能商品を絞ると1,000顧客にはできるけど・・・
    * $p_i$ を追加。CV目標の違反量。これを重みづけして混ぜて最適化
        * 連続変数が入るので問題は難しくなっている
* 列生成法とラグランジュ緩和法を組み合わせる
    * 10,000顧客まで解けるように
    * Oracle, Primal*, QUERY を反復する
    * $P$ パターン集合、 $g_{uip}$ CV期待値
    * ラグランジュ乗数でCV目標制約を制御
    * ラグランジュ緩和問題が下界を与える
    * item×userから、userごとの制約に書き換えられる
    * 反復回数は10回、40～50回

<!--

## @ simizut22 さん

-->
