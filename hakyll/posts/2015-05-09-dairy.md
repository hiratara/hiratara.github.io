---
title: 5/9の日記
---

## Haskellあれこれ

スレッド周りで悩む。AnyEventでシングルスレッドだったものをマルチスレッドに書き換えようとしてるので、グローバル変数は基本的に全部`MVar`になるのだけど、その際のロック周りの戦略はきちんと考え直さなきゃならないところ。`MVar`が再入不可なので、そこも整理しつつ。何も考えずにtakeとputすると非同期例外に対して安全にならないのだけど、maskを使いこなせる自信もなくどうしようかなーと。

